{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "LLMstruct Data Sorter Plugin Schema",
  "description": "Schema for data sorting and consolidation operations in llmstruct",
  "type": "object",
  "required": ["consolidation_metadata", "source_files", "output_artifacts", "artifact_id"],
  "metadata": {
    "project_name": "llmstruct",
    "description": "Schema for data sorting and consolidation plugin",
    "authors": [{"name": "@kpblcaoo", "github": "kpblcaoo"}]
  },
  "version": "0.1.0",
  "status": "Draft",
  "author": "@kpblcaoo", 
  "date": "2025-05-24",
  "license": "GPL-3.0",
  "artifact_id": "sorter-schema-001",
  "summary": "Schema for data sorter plugin operations",
  "tags": ["data", "sorting", "consolidation", "plugin"],
  
  "properties": {
    "consolidation_metadata": {
      "type": "object",
      "required": ["method", "processing_date", "confidence_threshold"],
      "properties": {
        "method": {
          "type": "string",
          "enum": ["smart_llm_assisted", "pattern_based", "manual_review", "hybrid"]
        },
        "processing_date": {"type": "string", "format": "date-time"},
        "confidence_threshold": {"type": "number", "minimum": 0, "maximum": 1},
        "total_files_processed": {"type": "integer", "minimum": 0},
        "success_rate": {"type": "number", "minimum": 0, "maximum": 1},
        "quality_metrics": {
          "type": "object",
          "properties": {
            "deduplication_rate": {"type": "number"},
            "corruption_rate": {"type": "number"}, 
            "pattern_match_accuracy": {"type": "number"}
          }
        }
      }
    },
    
    "source_files": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["path", "analysis_result"],
        "properties": {
          "path": {"type": "string"},
          "size_bytes": {"type": "integer"},
          "encoding": {"type": "string"},
          "analysis_result": {
            "type": "object",
            "properties": {
              "content_type": {"type": "string", "enum": ["tasks", "ideas", "artifacts", "unknown", "corrupted"]},
              "confidence": {"type": "number", "minimum": 0, "maximum": 1},
              "detected_items": {"type": "array"},
              "issues": {"type": "array", "items": {"type": "string"}},
              "pattern_matches": {"type": "object"}
            }
          },
          "destination": {"type": "string", "enum": ["consolidated", "quarantine", "archive"]},
          "artifact_refs": {"type": "array", "items": {"type": "string"}}
        }
      }
    },
    
    "output_artifacts": {
      "type": "array", 
      "items": {
        "type": "object",
        "required": ["artifact_id", "type", "path"],
        "properties": {
          "artifact_id": {"type": "string", "pattern": "^[a-f0-9-]+$"},
          "type": {"type": "string", "enum": ["consolidated_tasks", "consolidated_ideas", "consolidated_artifacts", "processing_report"]},
          "path": {"type": "string"},
          "item_count": {"type": "integer", "minimum": 0},
          "deduplication_applied": {"type": "boolean"},
          "validation_status": {"type": "string", "enum": ["valid", "warnings", "errors", "pending"]},
          "schema_compliance": {"type": "boolean"}
        }
      }
    },
    
    "correlation_analysis": {
      "type": "object",
      "description": "Cross-reference analysis between consolidated data and existing JSONs",
      "properties": {
        "task_idea_correlations": {"type": "array"},
        "duplicate_detection": {"type": "array"},
        "missing_references": {"type": "array"},
        "consistency_issues": {"type": "array"}
      }
    },
    
    "integration_plan": {
      "type": "object",
      "description": "Plan for integrating sorted data into main JSON system",
      "properties": {
        "target_files": {"type": "array", "items": {"type": "string"}},
        "merge_strategy": {"type": "string", "enum": ["append", "replace", "merge", "manual_review"]},
        "backup_required": {"type": "boolean"},
        "validation_steps": {"type": "array"},
        "rollback_plan": {"type": "string"}
      }
    }
  }
}
