# TODO: Fallback для анализа дубликатов без исходников в struct.json

Если в struct.json отсутствует поле `source` у функций, анализатор дубликатов должен:
- Извлекать тело функции из исходного файла по диапазону строк (если есть start/end).
- Строить AST-хеш на лету.
- В CLI выводить предупреждение: "struct.json не содержит исходников, используем fallback-анализ по файлам".

Это позволит делать глубокий анализ даже с "лёгким" struct.json.

**Приоритет:** средний (важно для больших проектов и быстрой работы CLI)

---

# Идеи для развития модульного индекса и архитектуры анализа

- Перейти на модульный индекс: хранить struct.json и ast.json для каждого файла/модуля в .llmstruct_index/ с повторением структуры исходного кода.
- В корневом struct.json хранить только summary/overview, а для глубокого анализа агрегировать данные из .llmstruct_index/.
- Добавить быстрый поиск и агрегацию по модульным индексам (например, для анализа дубликатов, метрик, навигации).
- Реализовать автоматическую синхронизацию: при изменении исходника пересоздавать только соответствующий модульный индекс.
- Добавить опцию CLI для анализа только по модульному индексу (ускорение для больших проектов).
- Ввести кеширование AST-хешей и быстрый diff для incremental анализа. 